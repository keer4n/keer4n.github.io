<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Using BFG to clean out unwanted/sensitive files in a git repository</title>
<meta name="generator" content="Org Mode" />

<link rel="stylesheet" href="/css/htmlize.css" />
<link rel="stylesheet" href="/css/main.css" />
<link rel="stylesheet" href="/css/main-light.css" />
<link rel="stylesheet" href="/css/style.css" />
<script src="/js/index.js" defer></script>
</head>
<body>
<div id="preamble" class="status">
<nav class="menu"><ul><li>keer4n</li> <li><a href="/">/</a></li> <li><a href="/demos">/demos</a></li> <li><a href="/links.html">/links</a></li></ul></nav><div id="updated"> Updated: 2024-01-05 Fri 06:59</div>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Using BFG to clean out unwanted/sensitive files in a git repository</h1>
</header><p>
The goal is to clean a git repository with unwanted/sensitive files. For eg. Some
key/password files were uploaded to the remote git repo. Then, git will preserve their
history regardless of if you delete it later (that's what git is for). To completely
eradicate it from your git history quickly and painlessly, BFG repo-cleaner<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup> can
be used.
</p>

<p>
For arch linux, you can install the tool from AUR with `yay` with:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ yay -S bfg
</pre>
</div>

<p>
First, start with deleting the unwanted files and commiting to remote as BFG won't
modify your latest commit to delete those files. Once the files are deleted, the
git history can be cleaned.
</p>

<p>
Next, clone the git database (.git folder) for your repo using:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ git clone --mirror git@github.com:username/some-unclean-repo.git
</pre>
</div>

<p>
Now you can run BFG-specific commands to clean your repo.
To delete a file:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ bfg --delete-files file_name some-unclean-repo.git
</pre>
</div>

<p>
To delete a folder:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ bfg --delete-folders folder_name some-unclean-repo.git
</pre>
</div>

<p>
Then, go into your folder and clean unwanted data using:
</p>

<div class="org-src-container">
<pre class="src src-sh">$ cd some-unclean-repo.git
$ git reflog expire --expire=now --all &amp;&amp; git gc --prune=now --aggressive
</pre>
</div>

<p>
Now, you can push it to remote to have an updated clean history using <code>git push</code> and it is recommended
to reclone the repo for future use to prevent unwarranted pushing of dirty history.
</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
<a href="https://rtyley.github.io/bfg-repo-cleaner/">BFG Repo-Cleaner</a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<div><a href="https://github.com/keer4n">~</a></div><div> Generated by <a href="https://www.gnu.org/software/emacs/">Emacs</a> 29.1 (<a href="https://orgmode.org">Org</a> mode 9.6.6)</div>
</div>
</body>
</html>